// Role-Based Access Control Constants

const ROLES = {
  OWNER: 'OWNER',
  EDITOR: 'EDITOR',
  VIEWER: 'VIEWER'
};

const PERMISSIONS = {
  // Budget permissions
  VIEW_BUDGET: 'VIEW_BUDGET',
  CREATE_BUDGET_ITEM: 'CREATE_BUDGET_ITEM',
  EDIT_BUDGET_ITEM: 'EDIT_BUDGET_ITEM',
  DELETE_BUDGET_ITEM: 'DELETE_BUDGET_ITEM',
  CREATE_CATEGORY: 'CREATE_CATEGORY',
  EDIT_CATEGORY: 'EDIT_CATEGORY',
  DELETE_CATEGORY: 'DELETE_CATEGORY',

  // Guest permissions
  VIEW_GUESTS: 'VIEW_GUESTS',
  ADD_GUEST: 'ADD_GUEST',
  EDIT_GUEST: 'EDIT_GUEST',
  DELETE_GUEST: 'DELETE_GUEST',
  UPDATE_RSVP: 'UPDATE_RSVP',

  // Event permissions
  VIEW_EVENTS: 'VIEW_EVENTS',
  CREATE_EVENT: 'CREATE_EVENT',
  EDIT_EVENT: 'EDIT_EVENT',
  DELETE_EVENT: 'DELETE_EVENT',

  // Notes permissions
  VIEW_NOTES: 'VIEW_NOTES',
  CREATE_NOTE: 'CREATE_NOTE',
  EDIT_NOTE: 'EDIT_NOTE',
  DELETE_NOTE: 'DELETE_NOTE',

  // Profile permissions
  VIEW_PROFILE: 'VIEW_PROFILE',
  EDIT_PROFILE: 'EDIT_PROFILE',

  // Admin permissions
  INVITE_USER: 'INVITE_USER',
  REMOVE_USER: 'REMOVE_USER',
  CHANGE_USER_ROLE: 'CHANGE_USER_ROLE'
};

// Role to Permissions mapping
const ROLE_PERMISSIONS = {
  OWNER: [
    // All budget permissions
    PERMISSIONS.VIEW_BUDGET,
    PERMISSIONS.CREATE_BUDGET_ITEM,
    PERMISSIONS.EDIT_BUDGET_ITEM,
    PERMISSIONS.DELETE_BUDGET_ITEM,
    PERMISSIONS.CREATE_CATEGORY,
    PERMISSIONS.EDIT_CATEGORY,
    PERMISSIONS.DELETE_CATEGORY,

    // All guest permissions
    PERMISSIONS.VIEW_GUESTS,
    PERMISSIONS.ADD_GUEST,
    PERMISSIONS.EDIT_GUEST,
    PERMISSIONS.DELETE_GUEST,
    PERMISSIONS.UPDATE_RSVP,

    // All event permissions
    PERMISSIONS.VIEW_EVENTS,
    PERMISSIONS.CREATE_EVENT,
    PERMISSIONS.EDIT_EVENT,
    PERMISSIONS.DELETE_EVENT,

    // All notes permissions
    PERMISSIONS.VIEW_NOTES,
    PERMISSIONS.CREATE_NOTE,
    PERMISSIONS.EDIT_NOTE,
    PERMISSIONS.DELETE_NOTE,

    // Profile permissions
    PERMISSIONS.VIEW_PROFILE,
    PERMISSIONS.EDIT_PROFILE,

    // Admin permissions
    PERMISSIONS.INVITE_USER,
    PERMISSIONS.REMOVE_USER,
    PERMISSIONS.CHANGE_USER_ROLE
  ],

  EDITOR: [
    // Budget permissions (no delete)
    PERMISSIONS.VIEW_BUDGET,
    PERMISSIONS.CREATE_BUDGET_ITEM,
    PERMISSIONS.EDIT_BUDGET_ITEM,
    PERMISSIONS.CREATE_CATEGORY,
    PERMISSIONS.EDIT_CATEGORY,

    // Guest permissions (no delete)
    PERMISSIONS.VIEW_GUESTS,
    PERMISSIONS.ADD_GUEST,
    PERMISSIONS.EDIT_GUEST,
    PERMISSIONS.UPDATE_RSVP,

    // Event permissions (no delete)
    PERMISSIONS.VIEW_EVENTS,
    PERMISSIONS.CREATE_EVENT,
    PERMISSIONS.EDIT_EVENT,

    // Notes permissions (no delete)
    PERMISSIONS.VIEW_NOTES,
    PERMISSIONS.CREATE_NOTE,
    PERMISSIONS.EDIT_NOTE,

    // Profile permissions (view only)
    PERMISSIONS.VIEW_PROFILE
  ],

  VIEWER: [
    // Read-only permissions
    PERMISSIONS.VIEW_BUDGET,
    PERMISSIONS.VIEW_GUESTS,
    PERMISSIONS.VIEW_EVENTS,
    PERMISSIONS.VIEW_NOTES,
    PERMISSIONS.VIEW_PROFILE
  ]
};

module.exports = {
  ROLES,
  PERMISSIONS,
  ROLE_PERMISSIONS
};
